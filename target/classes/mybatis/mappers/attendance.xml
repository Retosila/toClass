<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mapper.attendance">

    <resultMap id="attendResult" type="attendVO">
        <result property="member_name" column="member_name" />
        <result property="attend_time" column="attendance_regdate" />
        <result property="attend_status" column="attendance_status" />
    </resultMap>
    <resultMap id="memberEmailResult" type="attendDTO"> <!-- id는 mapper의 이름과 같아도 사용 가능 -->
        <result property="member_email" column="member_email" />
        <result property="monday" column="monday" />
        <result property="friday" column="friday" />
    </resultMap>
    <select id="getAttendanceInfoByDTO"  resultMap="attendResult" parameterType="attendDTO">
	<![CDATA[
        select m.member_name, a.attendance_regdate, a.attendance_status
        from attendance a inner join member m using(member_email)
        where (a.attendance_regdate between #{monday} and #{friday})
          and member_email = #{member_email}
        order by a.attendance_regdate asc
        ]]>
  </select>
    <select id="getClassMemberEmail" resultMap="memberEmailResult" parameterType="string">
		<![CDATA[
        select i.member_email
        from info i inner join member m on(i.member_email = m.member_email)
        where i.class_id = 'CLS000001' and m.member_type='학생'
        ]]>
	</select>
</mapper>
